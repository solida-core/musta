from snakemake.utils import min_version
import yaml as yaml

##### set minimum snakemake version #####
min_version("6.4.1") ## DECIDO COSA METTERE COME VERSIONE MINIMAL

# configfile: "../config/config.yaml"
# with open(config["samples"],'r') as file:
#     samples_master = yaml.load(file, Loader=yaml.FullLoader)
#     samples_master.keys()
# samples=list(samples_master.keys())

##### setup report #####
configfile: "../config/config.yaml"


report: "../report/workflow.rst"


##### setup singularity #####
# this container defines the underlying OS for each job when using the workflow
# with --use-conda --use-singularity
container: "docker://continuumio/miniconda3"


##### load rules #####
include: "rules/common.smk"
include: "rules/call_variants.smk"
include: "rules/call_variants_tumoronly.smk"
include: "rules/filter_results.smk"
include: "rules/annotation.smk"


##### target rules #####

rule all:
    input:
        expand("results/{sample}_somatic_filtered_selected.vcf.gz",sample=list(samples_master.keys())),
        expand("results/annotation/funcotator/{sample}_funcotated.maf",sample=list(samples_master.keys())),
